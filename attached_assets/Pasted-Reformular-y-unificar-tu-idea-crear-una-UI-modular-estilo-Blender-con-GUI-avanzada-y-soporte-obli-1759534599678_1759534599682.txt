Reformular y unificar tu idea: crear una UI modular (estilo Blender) con GUI avanzada y soporte obligatorio de imagen de fondo, y garantizar que las curvas de segmentos sean arcos circulares matemáticamente correctos (curva perfecta), con controles para definirlas por ángulo, radio o sagitta.

Especificación combinada (para desarrollador / README)
Interfaz modular (Dockable)
Áreas reordenables: Viewport (central), Outliner, Properties, Tool Settings, Background Panel.
Guardar layout en localStorage; atajos para cambiar espacios de trabajo.
Layout responsive: modo compact, modo completo.
GUI avanzada (UX)
Tool Settings dinámicos: cada herramienta muestra controles contextuales (ej.: Add Segment muestra color picker, preset curves y modos de creación).
Menú contextual en vértice/segmento: delete, snap, duplicate, set curve preset.
Multi-select + transform gizmo para mover/escala/rotación de grupos.
Snapping (grid/angle/background edges) y visual guides.
Tooltips, tutorial overlay y temas (claro/oscuro).
Imagen de fondo (obligatoria)
Requerido: siempre puede cargarse una imagen de fondo; la UI no permitirá exportar sin una imagen si se marca como "obligatoria".
Controles:
Cargar (file/drag&drop), mostrar preview y guardarla en .hbs como DataURL.
Opacity (0–1), Scale (0.1–5), Offset X/Y, Fit/Cover/Center modes, Lock-to-Map.
Mover/transformar desde viewport con handles (arrastrar imagen o corner handles).
Reset, Center, Snap-to-grid, Align-to-bounds.
Performance: downscale para preview; usar full-res sólo al exportar (opcional).
Persistencia: guardar bg (dataURL + metadata: scale, offset, opacity) en mapData y exportar en .hbs.
Curva perfecta (requisito clave)
Representación: segmentos con curve deben representarse y editarse como arcos circulares exactos (no aproximaciones bezier). Implementación:
Datos permitidos: especificar curva por (a) ángulo en grados, (b) radio del arco, o (c) sagitta (altura de la cuerda).
Conversión automática entre los tres parámetros (fórmulas geométricas).
En el renderer, calcular centro y radio con precisión y dibujar usando ctx.arc(...) con los ángulos start/end y sentido correcto.
Detección (hit-test) de segmentos curvos: muestreo fino basado en ángulo subtendido o cálculo geométrico directo (distancia a arco).
Edición interactiva: slider/number para cualquiera de los tres parámetros y manipulación directa con gizmo que muestra el centro del círculo y la flecha de sagitta.
Validación: clamping para evitar divisiones por cero o arcos imposibles (radio demasiado pequeño para la longitud de la cuerda), mensajes de error/tooltip si el parámetro es inválido.
Export / Import
.hbs incluye: vertexes, segments (v0,v1,color) y curva expresada como valor canónico (ej. angleSigned). Mantener la inversión de signo si sigue siendo necesaria para compatibilidad Haxball (documentar claramente).
Guardar metadatos de background (dataURI + scale/offset/opacity).