Prompt (solo las cosas nuevas)
Añadir estas mejoras a la app HaxTrace:

Interfaz modular (sin topbar)
Reemplazar la topbar fija por un sistema de paneles acoplables (dockable). Panels mínimos:
Tools (herramientas: Add Vertex, Add Segment, Pan)
View (zoom, Toggle Theme, Toggle Grid)
Outliner / Properties / Background (sidebar ya existente puede convertirse en panel)
Requisito: los paneles deben poder arrastrarse (drag) y re-ordenarse; layout persistente en localStorage.
Archivo(s): index.html, styles.css, crear js/docking.js (o añadir lógica simple de drag/drop en main.js).
GUI mucho más avanzada (visual + funcional)
Tool Settings contextuales: cada herramienta muestra controles específicos en su panel (por ejemplo, Add Segment muestra color picker y presets de curva).
Menú contextual en vértices/segmentos con acciones rápidas (delete, duplicate, snap).
Theme toggle (claro/oscuro) y compact mode.
Grid visual en viewport con toggle y tamaño ajustable.
Multi-select + transform gizmo (mover/grupo/scale básico).
Archivo(s): uiManager.js, tools.js, styles.css, index.html.
Imagen de fondo (OBLIGATORIA)
Debe poder cargarse una imagen de fondo y ser manipulable desde UI:
Cargar (file/drag&drop), Opacity (0–1), Scale (0.1–5), Offset X/Y, Fit/Cover/Center, Lock-to-Map.
Mover/scale directo desde viewport con handles.
Persistir en el .hbs exportado (guardar DataURL + metadata: scale/offset/opacity).
Validación: si el usuario marca “bg required”, impedir exportar hasta que haya una imagen cargada.
Archivo(s): renderer.js (dibujado y propiedades bgImage, bgScale, bgOffset, bgOpacity), importExport.js (guardar/restaurar DataURL + metadata), index.html (Background panel).
Curva perfecta (arco circular exacto)
Reemplazar aproximaciones bezier por arcos circulares exactos:
Permitir editar curva por cualquiera de: ángulo (grados), radio, sagitta (altura de la cuerda). Proveer conversión automática entre ellos.
En renderer.render() calcular centro y radio exactos y dibujar con ctx.arc(...).
Hit-test: usar cálculo geométrico para distancia al arco o muestreo fino si procede.
Edición interactiva: slider/number para angle/radius/sagitta y gizmo que muestra centro y sagitta.
Archivo(s): renderer.js, main.js, uiManager.js.